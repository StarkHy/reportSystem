=================================
Word 模板创建指南
=================================

本文档说明如何创建用于 poi-tl 1.12.1 的 Word 模板。

=================================
模板标签语法
=================================

1. 文本标签: {{variable}}
   - 示例: {{name}}、{{department}}、{{score}}

2. 图片标签: {{@image}}
   - 示例: {{@logo}}、{{@signature}}

3. 表格标签: {{#table}}
   - 表格中每行数据对应一个对象
   - 表格会自动循环渲染数据列表

4. 列表标签: {{*list}}
   - 列表项会自动循环渲染

=================================
模板示例
=================================

---------------------------------
文档头部
---------------------------------
标题: 员工考核报告
员工姓名: {{name}}
员工编号: {{employeeId}}
部门: {{department}}
职位: {{position}}
报告日期: {{reportDate}}

---------------------------------
正文部分
---------------------------------
一、基本信息

姓名: {{name}}
性别: {{gender}}
年龄: {{age}}
入职日期: {{joinDate}}
联系电话: {{phone}}
邮箱: {{email}}

二、考核结果

综合评分: {{overallScore}}
考核等级: {{level}}
排名: {{rank}}

三、考核维度

（表格）
| 考核维度 | 分数 | 权重 | 评价 |
|----------|------|------|------|
| {{#dimensions}} |  |  |  |
| {{dimension}} | {{score}} | {{weight}} | {{comment}} |

四、项目经历

（表格）
| 项目名称 | 角色 | 时间 | 完成度 | 成果 |
|----------|------|------|--------|------|
| {{#projects}} |  |  |  |  |
| {{projectName}} | {{role}} | {{startDate}} - {{endDate}} | {{completion}}% | {{achievement}} |

五、优势与不足

优势:
{{*strengths}}

改进:
{{*improvements}}

六、总结

{{summary}}

七、签字

员工签字: {{@signature}}
日期: {{signature.date}}

审批人: {{signature.approver}}
审批日期: {{signature.approveDate}}

=================================
样式设置建议
=================================

1. 在 Word 中直接设置文本样式（字体、大小、颜色等）
2. poi-tl 会保留模板中的样式
3. 表格样式在 Word 中设置后会被保留
4. 建议使用 Word 的样式功能统一格式

=================================
注意事项
=================================

1. 变量名必须与 Groovy 脚本中设置的变量名一致
2. 表格标签 {{#}} 应该放在表格的第一行
3. 列表标签 {{*}} 应该放在列表的第一个项目符号位置
4. 图片标签 {{@}} 用于图片占位
5. 标签名称区分大小写
6. 不要在标签中添加多余的空格

=================================
测试方法
=================================

1. 创建模板文件 test_template.docx
2. 上传到系统的模板管理
3. 复制 simple_test.txt 中的脚本到 Groovy 脚本输入框
4. 使用 test_data.json 作为测试数据（或留空让脚本生成）
5. 点击生成按钮测试

=================================
常见问题
=================================

Q: 表格没有正确渲染？
A: 确保 {{#table}} 标签在表格第一行，并且列名与数据对象属性名匹配。

Q: 图片不显示？
A: 确保使用 {{@image}} 格式的标签，并且 Groovy 脚本中设置了正确的图片数据。

Q: 列表没有渲染？
A: 确保使用 {{*list}} 格式的标签，并且数据是 List 类型。

Q: 样式不生效？
A: 样式应该在 Word 模板中设置，Groovy 脚本中使用 Style 类设置数据样式。
