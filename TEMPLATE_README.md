# 测试模板使用说明

## 文件说明

- **test_template.html** - Word 模板的 HTML 格式预览
- **test_template_script.txt** - 配套的测试 Groovy 脚本
- **test_template.docx** - 实际使用的 Word 模板（需要自行转换）

## 如何创建 Word 模板

### 方法1：从 HTML 转换（推荐）

1. **打开 HTML 文件**
   - 在浏览器中打开 `test_template.html`
   - 或使用 Word 直接打开 HTML 文件

2. **另存为 Word 文档**
   - 在 Word 中：文件 > 另存为 > 选择位置
   - 保存类型选择：Word 文档 (*.docx)
   - 文件名：`test_template.docx`

3. **验证模板**
   - 打开生成的 .docx 文件
   - 检查格式和样式是否正确
   - 确认占位符显示正常

### 方法2：手动创建 Word 模板

1. 创建新的 Word 文档
2. 复制 `test_template.html` 的内容到 Word
3. 调整格式和样式
4. 保存为 `test_template.docx`

## 模板占位符说明

### 基本信息占位符

| 占位符 | 说明 | 示例值 |
|--------|------|--------|
| {{title}} | 报告标题 | 2024年第一季度员工考核报告 |
| {{reportId}} | 报告编号 | RPT2024-Q1-001 |
| {{reportDate}} | 生成日期 | 2024-01-15 |
| {{name}} | 员工姓名 | 张三 |
| {{employeeId}} | 员工编号 | EMP20240115001 |
| {{department}} | 部门 | 研发部 |
| {{position}} | 职位 | 高级工程师 |
| {{level}} | 职级 | P6 |
| {{gender}} | 性别 | 男 |
| {{age}} | 年龄 | 30 |
| {{joinDate}} | 入职日期 | 2022-03-15 |

### 考核结果占位符

| 占位符 | 说明 | 示例值 |
|--------|------|--------|
| {{reportPeriod}} | 考核周期 | 2024年第一季度 |
| {{overallScore}} | 综合评分 | 88.5 |
| {{level}} | 考核等级 | 良好 |
| {{rank}} | 排名 | 15/50 |
| {{reviewer}} | 考核人 | 王经理 |
| {{reviewerDepartment}} | 考核部门 | 人力资源部 |

### 表格占位符

#### 考核维度表格

表格第一行（表头）：
```
| 考核维度 | 分数 | 权重 | 评价 |
```

第二行（数据行，循环）：
```
| {{dimension}} | {{score}} | {{weight}} | {{comment}} |
```

#### 项目经历表格

表格第一行（表头）：
```
| 项目名称 | 角色 | 项目时间 | 完成度 | 成果 |
```

第二行（数据行，循环）：
```
| {{projectName}} | {{role}} | {{startDate}} 至 {{endDate}} | {{completion}}% | {{achievement}} |
```

### 列表占位符

#### 优势列表
```
- {{strengths}}
```

#### 改进列表
```
- {{improvements}}
```

#### 发展目标列表
```
- {{goals}}
```

### 其他占位符

| 占位符 | 说明 | 示例值 |
|--------|------|--------|
| {{summary}} | 总结评价 | 该员工在过去一个季度表现优秀... |
| {{signature.employeeDate}} | 员工签字日期 | 2024-01-15 |
| {{signature.approveDate}} | 审批日期 | 2024-01-16 |

## 使用测试脚本

1. **上传模板**
   - 在系统的"模板管理"中上传 `test_template.docx`
   - 填写模板名称：员工考核报告
   - 可以不填写 API URL

2. **准备测试数据**
   - 打开 `test_template_script.txt`
   - 复制所有脚本内容

3. **生成报告**
   - 进入"生成报告"页面
   - 选择刚才上传的模板
   - 在 Groovy 脚本框中粘贴脚本
   - 点击"生成报告"按钮

4. **下载结果**
   - 生成成功后，点击下载链接
   - 打开 Word 文档查看结果

## 自定义数据

### 修改员工信息

在脚本中找到这部分代码并修改：
```groovy
data.put("name", "李四")  // 修改姓名
data.put("department", "市场部")  // 修改部门
// ... 其他字段
```

### 修改考核维度

在脚本中找到这部分代码并修改：
```groovy
def dimensions = [
    [
        dimension: "工作态度",  // 修改维度名称
        score: 92,  // 修改分数
        weight: "30%",  // 修改权重
        comment: "工作积极认真"  // 修改评价
    ],
    // ... 添加或删除其他维度
]
```

### 修改项目经历

在脚本中找到这部分代码并修改：
```groovy
def projects = [
    [
        projectName: "新项目名称",  // 修改项目名称
        role: "项目经理",  // 修改角色
        startDate: "2024-01-01",  // 修改开始日期
        endDate: "2024-03-31",  // 修改结束日期
        completion: 100,  // 修改完成度
        achievement: "项目成果描述"  // 修改成果
    ]
]
```

### 修改列表内容

```groovy
// 修改优势
def strengths = [
    "新的优势1",
    "新的优势2"
]

// 修改改进方向
def improvements = [
    "新的改进1",
    "新的改进2"
]
```

## 模板样式调整

### 在 Word 中修改样式

1. **字体设置**
   - 选中要修改的文字
   - 在"开始"选项卡中选择字体、大小、颜色

2. **表格样式**
   - 选中表格
   - 在"表格工具" > "设计"中选择样式

3. **段落格式**
   - 选中段落
   - 右键 > 段落 > 设置缩进、行距等

### 常用样式建议

- 标题：黑体、18pt、蓝色
- 小标题：黑体、14pt、蓝色
- 正文：宋体、12pt、黑色
- 表格标题：白色背景、蓝色文字、居中
- 分数：红色、加粗

## 注意事项

1. **占位符格式**
   - 必须使用双大括号：`{{variable}}`
   - 不要在占位符中添加空格

2. **表格循环**
   - 表格循环标记 `{{#}}` 应该放在表格的第一行
   - 确保列名与数据对象属性名匹配

3. **列表循环**
   - 列表循环标记 `{{*}}` 应该放在列表的第一个项目位置
   - 不要在列表项中添加额外的标记

4. **数据类型**
   - 表格数据必须是 List 类型
   - 列表数据必须是 List 类型
   - 其他数据可以是字符串、数字等

## 测试验证

生成报告后，检查以下内容：

- [ ] 所有占位符都被正确替换
- [ ] 表格数据完整显示
- [ ] 列表数据完整显示
- [ ] 格式和样式正确
- [ ] 日期格式正确
- [ ] 数字显示正确
- [ ] 中文显示正常

## 问题排查

### 数据不显示

1. 检查占位符名称是否与脚本中的变量名一致
2. 检查大小写是否匹配
3. 查看执行日志中的错误信息

### 表格不渲染

1. 确保 `{{#}}` 标签在表格第一行
2. 检查列名是否与数据对象属性名匹配
3. 确保数据是 List 类型

### 格式错乱

1. 在 Word 中重新调整格式
2. 保存后重新上传模板
3. 检查是否有特殊字符或格式问题

## 更多示例

参考以下文件获取更多示例：

- `test_groovy_scripts.txt` - 基础脚本示例
- `test_groovy_with_style.txt` - 带样式的脚本示例
- `GROOVY_TEST_GUIDE.md` - 完整的脚本指南
